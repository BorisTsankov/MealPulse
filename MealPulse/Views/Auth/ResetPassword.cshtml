@{
    ViewData["Title"] = "Reset Password";
}
@section Styles {
    <link rel="stylesheet" href="~/css/Auth.css" asp-append-version="true" />
}

<div class="auth-page">
    <div class="auth-card shadow-lg">
        <h1 class="mb-4">Set New Password</h1>

        <form asp-action="ResetPassword" method="post">
            <input type="hidden" name="token" value="@ViewBag.Token" />

            <div class="form-floating mb-3">
                <input type="password" name="password" class="form-control" id="password" placeholder="New Password" required />
                <label for="password">New Password</label>
            </div>

            <div class="form-floating mb-3">
                <input type="password" name="confirmPassword" class="form-control" id="confirmPassword" placeholder="Confirm Password" required />
                <label for="confirmPassword">Confirm Password</label>
            </div>

            <div class="password-rules mt-2 mb-3 small text-muted" id="passwordRules">
                <ul class="list-unstyled">
                    <li id="rule-length">• At least 8 characters</li>
                    <li id="rule-uppercase">• One uppercase letter</li>
                    <li id="rule-lowercase">• One lowercase letter</li>
                    <li id="rule-digit">• One number</li>
                    <li id="rule-special">• One special character (!&#64;#$%^&amp;*)</li>
                </ul>
            </div>

            <button type="submit" class="btn btn-gradient-purple w-100">Update Password</button>

            @if (!string.IsNullOrEmpty(ViewBag.Error))
            {
                <div class="alert alert-danger mt-3 text-center">@ViewBag.Error</div>
            }

            @if (!string.IsNullOrEmpty(ViewBag.Success))
            {
                <div class="alert alert-success mt-3 text-center">@ViewBag.Success</div>
            }
        </form>
    </div>
</div>

@section Scripts {
    <script>
        const passwordInput = document.getElementById("password");
        const rules = {
            length: document.getElementById("rule-length"),
            uppercase: document.getElementById("rule-uppercase"),
            lowercase: document.getElementById("rule-lowercase"),
            digit: document.getElementById("rule-digit"),
            special: document.getElementById("rule-special")
        };

        passwordInput.addEventListener("input", () => {
            const value = passwordInput.value;

            rules.length.style.color = value.length >= 8 ? "green" : "gray";
            rules.uppercase.style.color = /[A-Z]/.test(value) ? "green" : "gray";
            rules.lowercase.style.color = /[a-z]/.test(value) ? "green" : "gray";
            rules.digit.style.color = /\d/.test(value) ? "green" : "gray";
            rules.special.style.color =  /[!&#64;#$%^&amp;*]/.test(value) ? "green" : "gray";
        });
    </script>
}
